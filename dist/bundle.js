(()=>{"use strict";var t={931:(t,e,o)=>{o.d(e,{Z:()=>r});var r=function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.id=null,this.x=0,this.y=0,this.radius=0,this.overlay=!1}},548:(t,e,o)=>{function r(t){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function n(t,e){for(var o=0;o<e.length;o++){var r=e[o];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function i(t,e){return(i=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function a(t,e){return!e||"object"!==r(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function c(t){return(c=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}o.d(e,{Z:()=>u});var u=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&i(t,e)}(f,t);var e,r,u,s,l=(u=f,s=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=c(u);if(s){var o=c(this).constructor;t=Reflect.construct(e,arguments,o)}else t=e.apply(this,arguments);return a(this,t)});function f(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,f),(t=l.call(this)).used=!1,t.setRandomPosition(),t}return e=f,(r=[{key:"setRandomPosition",value:function(){var t=o.g.background.canvas.width,e=o.g.background.canvas.height;this.x=Math.floor(Math.random()*(.6*t))+.2*t,this.y=Math.floor(Math.random()*(.6*e))+.2*t}},{key:"update",value:function(){this.detectHit()}},{key:"hit",value:function(t){return Math.pow(this.radius-t.radius,2)<=Math.pow(this.x-t.x,2)+Math.pow(this.y-t.y,2)&&Math.pow(this.x-t.x,2)+Math.pow(this.y-t.y,2)<=Math.pow(this.radius+t.radius,2)}}])&&n(e.prototype,r),f}(o(557).Z)},557:(t,e,o)=>{o.d(e,{Z:()=>l});var r=o(931),n=o(805);function i(t){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function a(t,e){for(var o=0;o<e.length;o++){var r=e[o];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function c(t,e){return(c=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function u(t,e){return!e||"object"!==i(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function s(t){return(s=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var l=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&c(t,e)}(h,t);var e,r,i,l,f=(i=h,l=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=s(i);if(l){var o=s(this).constructor;t=Reflect.construct(e,arguments,o)}else t=e.apply(this,arguments);return u(this,t)});function h(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,h),(t=f.call(this)).speed=0,t.dx=0,t.dy=0,t.wallHit=!1,t.type=null,t}return e=h,(r=[{key:"move",value:function(){if(this.wallHit=this.getWallHit(),!1===this.wallHit)"Enemy"==this.type?(this.x+=this.speed*this.dx,this.y+=this.speed*this.dy):(this.x+=this.dx,this.y+=this.dy);else if("Projectile"===this.type)delete o.g.player.projectiles[this.id];else if("Player"==this.type){var t=this.hitDoor();!1!==t&&(o.g.player.room=n.Z.rooms[o.g.player.room].changeRoom(t.direction),o.g.background.draw(),this.x=t.x,this.y=t.y)}else"Enemy"==this.type&&("up"===this.wallHit||"down"===this.wallHit?this.dy*=-1:"right"!==this.wallHit&&"left"!==this.wallHit||(this.dx*=-1),this.x+=this.speed*this.dx,this.y+=this.speed*this.dy)}},{key:"getWallHit",value:function(){return this.x+this.radius+this.dx>o.g.background.canvas.width-o.g.background.ctx.lineWidth?"right":this.x-this.radius+this.dx<0+o.g.background.ctx.lineWidth?"left":this.y+this.radius+this.dy>o.g.background.canvas.height-o.g.background.ctx.lineWidth?"down":this.y-this.radius+this.dy<0+o.g.background.ctx.lineWidth&&"up"}},{key:"variableBetweenValues",value:function(t,e,o){return t>=e&&t<=o}}])&&a(e.prototype,r),h}(r.Z)},805:(t,e,o)=>{o.d(e,{Z:()=>x});var r=o(931),n=o(548);function i(t){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function a(t,e){for(var o=0;o<e.length;o++){var r=e[o];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function c(t,e){return(c=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function u(t,e){return!e||"object"!==i(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function s(t){return(s=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var l=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&c(t,e)}(f,t);var e,r,n,i,l=(n=f,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=s(n);if(i){var o=s(this).constructor;t=Reflect.construct(e,arguments,o)}else t=e.apply(this,arguments);return u(this,t)});function f(t){var e;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,f),(e=l.call(this)).value=0,e.id=t,e.value=100*Math.floor(9*Math.random())+100,e.radius=o.g.background.canvas.height/20,e}return e=f,(r=[{key:"detectHit",value:function(){this.hit(o.g.player)&&!1===this.used&&(this.used=!0,o.g.player.updateScore(this.value),delete x.rooms[o.g.player.room].treasure[this.id])}}])&&a(e.prototype,r),f}(n.Z);function f(t){return(f="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function h(t,e){for(var o=0;o<e.length;o++){var r=e[o];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function y(t,e){return(y=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function d(t,e){return!e||"object"!==f(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function p(t){return(p=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var g=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&y(t,e)}(c,t);var e,r,n,i,a=(n=c,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=p(n);if(i){var o=p(this).constructor;t=Reflect.construct(e,arguments,o)}else t=e.apply(this,arguments);return d(this,t)});function c(t){var e;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,c),(e=a.call(this)).levels={1:[7,1],2:[10,2],3:[15,3],4:[20,4],5:[25,5]},e.level=null,e.id=t,e.type="Enemy",e.level=Math.floor(5*Math.random())+1,e.radius=e.levels[e.level][0],e.speed=e.levels[e.level][1],e.dx=1,e.dy=1,e.setRandomDirection(),e}return e=c,(r=[{key:"setRandomDirection",value:function(){this.dx*=Math.pow(-1,Math.floor(10*Math.random())),this.dy*=Math.pow(-1,Math.floor(10*Math.random()))}},{key:"update",value:function(){this.detectHit(),this.radius=this.levels[this.level][0],this.speed=this.levels[this.level][1],this.move()}},{key:"detectHit",value:function(){var t=this;Object.keys(o.g.player.projectiles).forEach((function(e){var r=o.g.player.projectiles[e];t.hit(r)&&!1===r.used&&(r.used=!0,console.log("projectile hit enemy!"),t.projectileHit(r))})),this.hit(o.g.player)?!1===this.overlay&&(this.overlay=!0,o.g.player.updateScore(-200)):this.overlay=!1}},{key:"projectileHit",value:function(t){delete o.g.player.projectiles[t.id],this.level>1?this.level-=1:delete x.rooms[o.g.player.room].enemies[this.id]}}])&&h(e.prototype,r),c}(n.Z);function b(t){return(b="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function m(t,e){for(var o=0;o<e.length;o++){var r=e[o];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function v(t,e){return(v=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function w(t,e){return!e||"object"!==b(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function k(t){return(k=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var x=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&v(t,e)}(c,t);var e,r,n,i,a=(n=c,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=k(n);if(i){var o=k(this).constructor;t=Reflect.construct(e,arguments,o)}else t=e.apply(this,arguments);return w(this,t)});function c(t,e){var o;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,c),(o=a.call(this)).up="",o.right="",o.down="",o.left="",o.endRoom=!1,o.visited=!1,o.availableDirections=4,o.treasure={},o.markers={},o.enemies={},o.id=t,o.up=o.id-e,o.right=o.id+1,o.down=o.id+e,o.left=o.id-1,o.id<e?(o.up=null,o.availableDirections--):o.id>=Math.pow(e,2)-e&&(o.availableDirections--,o.down=null),o.id%e==0?(o.availableDirections--,o.left=null):o.id%e==e-1&&(o.availableDirections--,o.right=null),o.generateTreasure(),o.generateEnemies(),o}return e=c,(r=[{key:"generateTreasure",value:function(){if(Math.random()<=.8){var t=Object.keys(this.treasure).length;this.treasure[t]=new l(t)}}},{key:"generateEnemies",value:function(){if(Math.random()<=1){var t=Object.keys(this.treasure).length;this.enemies[t]=new g(t)}}},{key:"changeRoom",value:function(t){return this[t]}},{key:"addMarker",value:function(){var t=Object.keys(this.markers).length;this.markers[t]=new Marker(t),o.g.background.draw()}}])&&m(e.prototype,r),c}(r.Z);x.rooms=[]},673:(t,e,o)=>{o.r(e);var r=o(805);document.addEventListener("keydown",(function(t){"ArrowUp"===t.key||"Up"===t.key||"w"===t.key||"W"===t.key?o.g.player.dy=-o.g.player.speed:"ArrowRight"===t.key||"Right"===t.key||"d"===t.key||"D"===t.key?o.g.player.dx=o.g.player.speed:"ArrowDown"===t.key||"Down"===t.key||"s"===t.key||"S"===t.key?o.g.player.dy=o.g.player.speed:"ArrowLeft"===t.key||"Left"===t.key||"a"===t.key||"A"===t.key?o.g.player.dx=-o.g.player.speed:" "===t.key&&r.Z.rooms[o.g.player.room].addMarker()})),document.addEventListener("keyup",(function(t){"ArrowUp"!==t.key&&"UP"!==t.key&&"w"!==t.key&&"W"!==t.key&&"ArrowRight"!==t.key&&"Right"!==t.key&&"d"!==t.key&&"D"!==t.key&&"ArrowDown"!==t.key&&"Down"!==t.key&&"s"!==t.key&&"S"!==t.key&&"ArrowLeft"!==t.key&&"Left"!==t.key&&"a"!==t.key&&"A"!==t.key||(o.g.player.dx=0,o.g.player.dy=0)})),document.addEventListener("mousedown",(function(t){if(0===t.button&&t.clientY>=o.g.background.canvasRect.top&&t.clientY<=o.g.background.canvasRect.bottom&&t.clientX>=o.g.background.canvasRect.left&&t.clientX<=o.g.background.canvasRect.right){var e=t.clientX-o.g.background.canvasRect.x,r=t.clientY-o.g.background.canvasRect.y;o.g.player.fireProjectile(e,r)}})),window.onresize=function(){background=new Background,o.g.background.draw(),o.g.foreground=new Foreground,o.g.foreground.update(),o.g.player.resetPosition()}}},e={};function o(r){if(e[r])return e[r].exports;var n=e[r]={exports:{}};return t[r](n,n.exports,o),n.exports}o.d=(t,e)=>{for(var r in e)o.o(e,r)&&!o.o(t,r)&&Object.defineProperty(t,r,{enumerable:!0,get:e[r]})},o.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"==typeof window)return window}}(),o.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),o.r=t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},(()=>{function t(t,e){for(var o=0;o<e.length;o++){var r=e[o];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var e=function(){function e(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),this.canvas=null,this.ctx=null,this.dimensions=null,this.doorMin=null,this.doorMax=null,this.dimensions=.8*window.innerHeight,$(".background-image").width(this.dimensions/2),$(".background-image").height(this.dimensions/2)}var o,r;return o=e,(r=[{key:"clear",value:function(){this.ctx.clearRect(0,0,this.canvas.width,this.canvas.height)}}])&&t(o.prototype,r),e}();function r(t,e){for(var o=0;o<e.length;o++){var r=e[o];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var n=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.colours={},this.status=null,this.direction=null,this.colours.active="green",this.colours.disabled="black",this.colours.locked="red",this.status="disabled",this.direction=e}var e,n;return e=t,(n=[{key:"draw",value:function(){switch(this.direction){case"up":this.upDoor();break;case"right":this.rightDoor();break;case"down":this.downDoor();break;case"left":this.leftDoor()}}},{key:"upDoor",value:function(){o.g.background.ctx.beginPath(),o.g.background.ctx.strokeStyle=this.colours[this.status],o.g.background.ctx.moveTo(o.g.background.doorMin,0),o.g.background.ctx.lineTo(o.g.background.doorMax,0),o.g.background.ctx.stroke()}},{key:"rightDoor",value:function(){o.g.background.ctx.beginPath(),o.g.background.ctx.strokeStyle=this.colours[this.status],o.g.background.ctx.moveTo(o.g.background.canvas.width,o.g.background.doorMin),o.g.background.ctx.lineTo(o.g.background.canvas.width,o.g.background.doorMax),o.g.background.ctx.stroke()}},{key:"downDoor",value:function(){o.g.background.ctx.beginPath(),o.g.background.ctx.strokeStyle=this.colours[this.status],o.g.background.ctx.moveTo(o.g.background.doorMax,o.g.background.canvas.height),o.g.background.ctx.lineTo(o.g.background.doorMin,o.g.background.canvas.height),o.g.background.ctx.stroke()}},{key:"leftDoor",value:function(){o.g.background.ctx.beginPath(),o.g.background.ctx.strokeStyle=this.colours[this.status],o.g.background.ctx.moveTo(0,o.g.background.doorMax),o.g.background.ctx.lineTo(0,o.g.background.doorMin),o.g.background.ctx.stroke()}}])&&r(e.prototype,n),t}(),i=o(805);function a(t){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function c(t,e){for(var o=0;o<e.length;o++){var r=e[o];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function u(t,e){return(u=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function s(t,e){return!e||"object"!==a(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function l(t){return(l=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var f=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&u(t,e)}(y,t);var e,r,a,f,h=(a=y,f=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=l(a);if(f){var o=l(this).constructor;t=Reflect.construct(e,arguments,o)}else t=e.apply(this,arguments);return s(this,t)});function y(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,y),(t=h.call(this)).canvasRect=null,t.canvas=document.getElementById("canvas-background"),t.ctx=t.canvas.getContext("2d"),t.canvas.width=t.dimensions,t.canvas.height=t.dimensions,t.doorMin=t.dimensions*(5/12),t.doorMax=t.dimensions*(7/12),t.canvasRect=t.canvas.getBoundingClientRect(),t}return e=y,(r=[{key:"draw",value:function(){this.clear();var t=o.g.player.room;this.ctx.lineWidth=20,this.drawWalls(),this.drawDoors(t),this.drawMarkers()}},{key:"drawWalls",value:function(){this.ctx.beginPath(),this.ctx.strokeStyle="black",this.ctx.moveTo(0,0),this.ctx.lineTo(this.doorMin,0),this.ctx.moveTo(this.doorMax,0),this.ctx.lineTo(this.canvas.width,0),this.ctx.lineTo(this.canvas.width,this.doorMin),this.ctx.moveTo(this.canvas.width,this.doorMax),this.ctx.lineTo(this.canvas.width,this.canvas.height),this.ctx.lineTo(this.doorMax,this.canvas.height),this.ctx.moveTo(this.doorMin,this.canvas.height),this.ctx.lineTo(0,this.canvas.height),this.ctx.lineTo(0,this.doorMax),this.ctx.moveTo(0,this.doorMin),this.ctx.lineTo(0,0),this.ctx.stroke()}},{key:"drawDoors",value:function(t){var e=new n("up"),o=new n("right"),r=new n("down"),a=new n("left");i.Z.rooms[t].up&&(e.status="active"),i.Z.rooms[t].right&&(o.status="active"),i.Z.rooms[t].down&&(r.status="active"),i.Z.rooms[t].left&&(a.status="active"),e.draw(),o.draw(),r.draw(),a.draw()}},{key:"drawMarkers",value:function(){var t=this;Object.keys(i.Z.rooms[o.g.player.room].markers).forEach((function(e){var r=i.Z.rooms[o.g.player.room].markers[e];t.ctx.beginPath(),t.ctx.arc(r.x,r.y,r.radius,0,2*Math.PI),t.ctx.fillStyle="blue",t.ctx.fill()}))}}])&&c(e.prototype,r),y}(e);function h(t){return(h="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function y(t,e){for(var o=0;o<e.length;o++){var r=e[o];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function d(t,e){return(d=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function p(t,e){return!e||"object"!==h(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function g(t){return(g=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var b=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&d(t,e)}(u,t);var e,r,n,a,c=(n=u,a=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=g(n);if(a){var o=g(this).constructor;t=Reflect.construct(e,arguments,o)}else t=e.apply(this,arguments);return p(this,t)});function u(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,u),(t=c.call(this)).canvas=document.getElementById("canvas-foreground"),t.ctx=t.canvas.getContext("2d"),t.canvas.width=t.dimensions,t.canvas.height=t.dimensions,t}return e=u,(r=[{key:"update",value:function(){!0!==o.g.player.finished&&(this.clear(),o.g.player.move(),this.draw(),requestAnimationFrame(this.update.bind(this)))}},{key:"draw",value:function(){this.ctx.beginPath(),this.ctx.arc(o.g.player.x,o.g.player.y,o.g.player.radius,0,2*Math.PI),this.ctx.fillStyle="purple",this.ctx.fill();var t=this;Object.keys(i.Z.rooms[o.g.player.room].treasure).forEach((function(e){var r=i.Z.rooms[o.g.player.room].treasure[e];r.update(),t.ctx.beginPath(),t.ctx.arc(r.x,r.y,r.radius,0,2*Math.PI),t.ctx.fillStyle="gold",t.ctx.fill()})),Object.keys(i.Z.rooms[o.g.player.room].enemies).forEach((function(e){var r=i.Z.rooms[o.g.player.room].enemies[e];r.update(),t.ctx.beginPath(),t.ctx.arc(r.x,r.y,r.radius,0,2*Math.PI),t.ctx.fillStyle="red",t.ctx.fill()})),Object.keys(o.g.player.projectiles).forEach((function(e){var r=o.g.player.projectiles[e];r.move(),t.ctx.beginPath(),t.ctx.arc(r.x,r.y,r.radius,0,2*Math.PI),t.ctx.fillStyle="blue",t.ctx.fill()}))}}])&&y(e.prototype,r),u}(e),m=o(557);function v(t){return(v="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function w(t,e){for(var o=0;o<e.length;o++){var r=e[o];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function k(t,e){return(k=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function x(t,e){return!e||"object"!==v(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function O(t){return(O=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var j=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&k(t,e)}(c,t);var e,r,n,i,a=(n=c,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=O(n);if(i){var o=O(this).constructor;t=Reflect.construct(e,arguments,o)}else t=e.apply(this,arguments);return x(this,t)});function c(t,e,r){var n;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,c),(n=a.call(this)).angle=0,n.speed=5,n.id=t,n.type="Projectile",n.x=o.g.player.x,n.y=o.g.player.y,n.radius=o.g.background.canvas.height/100,n.setDirection(e,r),n}return e=c,(r=[{key:"setDirection",value:function(t,e){this.angle=Math.atan((e-this.y)/(t-this.x)),this.dx=this.speed*Math.cos(this.angle),this.dy=this.speed*Math.sin(this.angle),t-this.x<0&&(this.dx*=-1,this.dy*=-1)}}])&&w(e.prototype,r),c}(o(548).Z);function R(t){return(R="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function S(t,e){for(var o=0;o<e.length;o++){var r=e[o];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function P(t,e){return(P=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function Z(t,e){return!e||"object"!==R(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function M(t){return(M=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var _=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&P(t,e)}(u,t);var e,r,n,a,c=(n=u,a=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=M(n);if(a){var o=M(this).constructor;t=Reflect.construct(e,arguments,o)}else t=e.apply(this,arguments);return Z(this,t)});function u(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,u),(t=c.call(this)).room=null,t.score=0,t.time=0,t.won=!1,t.projectileCounter=0,t.projectiles={},t.type="Player",t.x=o.g.background.canvas.width/2,t.y=o.g.background.canvas.height/2,t.radius=o.g.background.canvas.height/40,t.speed=5,t.startTimer(),t}return e=u,(r=[{key:"startTimer",value:function(){var t=Date.now();setInterval((function(){if(!0!==o.g.player.finished){var e=Date.now()-t;o.g.player.time=Math.floor(e/1e3),$("#time").text("Time:  "+o.g.player.time)}}),100)}},{key:"hitDoor",value:function(){var t={};return null!==i.Z.rooms[o.g.player.room].up&&this.y-this.radius+this.dy-o.g.background.ctx.lineWidth<0&&this.variableBetweenValues(this.x,o.g.background.doorMin,o.g.background.doorMax)?(t.direction="up",t.x=this.x,t.y=o.g.background.canvas.height-this.radius-o.g.background.ctx.lineWidth):null!==i.Z.rooms[o.g.player.room].right&&this.x+this.radius+this.dx+o.g.background.ctx.lineWidth>o.g.background.canvas.width&&this.variableBetweenValues(this.y,o.g.background.doorMin,o.g.background.doorMax)?(t.direction="right",t.x=this.radius+o.g.background.ctx.lineWidth,t.y=this.y):null!==i.Z.rooms[o.g.player.room].down&&this.y+this.radius+this.dy+o.g.background.ctx.lineWidth>o.g.background.canvas.height&&this.variableBetweenValues(this.x,o.g.background.doorMin,o.g.background.doorMax)?(t.direction="down",t.x=this.x,t.y=this.radius+o.g.background.ctx.lineWidth):null!==i.Z.rooms[o.g.player.room].left&&this.x-this.radius+this.dx-o.g.background.ctx.lineWidth<0&&this.variableBetweenValues(this.y,o.g.background.doorMin,o.g.background.doorMax)?(t.direction="left",t.x=o.g.background.canvas.width-this.radius-o.g.background.ctx.lineWidth,t.y=this.y):t=!1,!1!==t&&"end"===i.Z.rooms[o.g.player.room][t.direction]&&(this.playerWon(),t=!1),t}},{key:"playerWon",value:function(){this.finished=!0,$("#result").text("You Win!!!")}},{key:"fireProjectile",value:function(t,e){this.projectiles[this.projectileCounter]=new j(this.projectileCounter,t,e),this.projectileCounter++}},{key:"updateScore",value:function(t){this.score+=t,$("#score").text("Score:  "+this.score)}},{key:"resetPosition",value:function(){this.x=o.g.background.canvas.width/2,this.y=o.g.background.canvas.height/2}}])&&S(e.prototype,r),u}(m.Z);function D(t,e){for(var o=0;o<e.length;o++){var r=e[o];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var T=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)}var e,r;return e=t,(r=[{key:"setupGame",value:function(){i.Z.rooms=[];for(var t=0;t<Math.pow(o.g.settings.gridSize,2);t++)i.Z.rooms.push(new i.Z(t,o.g.settings.gridSize));for(var e=0;e<i.Z.rooms.length;e++)Math.random()<=o.g.settings.removed&&this.deleteRoom(e);o.g.player.room=this.generateRandomRoom(),this.generateRandomEndRoom(),this.mapInvalid()&&(console.log("rebuilding map"),this.setupGame()),i.Z.rooms[o.g.player.room].treasure={},i.Z.rooms[o.g.player.room].markers={},i.Z.rooms[o.g.player.room].enemies={},console.log("startroom",o.g.player.room)}},{key:"deleteRoom",value:function(t){var e=i.Z.rooms[t].up;null!==e&&(i.Z.rooms[e].down=null,i.Z.rooms[e].availableDirections--);var o=i.Z.rooms[t].right;null!==o&&(i.Z.rooms[o].left=null,i.Z.rooms[o].availableDirections--);var r=i.Z.rooms[t].down;null!==r&&(i.Z.rooms[r].up=null,i.Z.rooms[r].availableDirections--);var n=i.Z.rooms[t].left;null!==n&&(i.Z.rooms[n].right=null,i.Z.rooms[n].availableDirections--),i.Z.rooms[t]=null}},{key:"generateRandomRoom",value:function(){var t=Math.floor(Math.random()*Math.pow(o.g.settings.gridSize,2));return null!==i.Z.rooms[t]?t:this.generateRandomRoom()}},{key:"generateRandomEndRoom",value:function(){var t=this.generateRandomRoom();if(4!==i.Z.rooms[t].availableDirections&&t!==o.g.player.room){for(var e=!1,r=["up","right","down","left"],n=null,a=null;!1===e;)n=r[a=Math.floor(Math.random()*r.length)],null===i.Z.rooms[t][n]?(e=!0,i.Z.rooms[t][n]="end"):r.splice(a,1);i.Z.rooms[t].endRoom=!0,console.log("end room:  ",t)}else this.generateRandomEndRoom()}},{key:"getUnvisitedNeighbors",value:function(t){var e=[];return null!==i.Z.rooms[t].up&&"end"!==i.Z.rooms[t].up&&!1===i.Z.rooms[i.Z.rooms[t].up].visited&&e.push(i.Z.rooms[t].up),null!==i.Z.rooms[t].right&&"end"!==i.Z.rooms[t].right&&!1===i.Z.rooms[i.Z.rooms[t].right].visited&&e.push(i.Z.rooms[t].right),null!==i.Z.rooms[t].down&&"end"!==i.Z.rooms[t].down&&!1===i.Z.rooms[i.Z.rooms[t].down].visited&&e.push(i.Z.rooms[t].down),null!==i.Z.rooms[t].left&&"end"!==i.Z.rooms[t].left&&!1===i.Z.rooms[i.Z.rooms[t].left].visited&&e.push(i.Z.rooms[t].left),e}},{key:"mapInvalid",value:function(){for(var t=o.g.player.room,e=null,r=[],n=!0,a=Math.pow(o.g.settings.gridSize,2);;)if(i.Z.rooms[t].visited=!0,!0===i.Z.rooms[t].endRoom&&(n=!1),(e=this.getUnvisitedNeighbors(t)).length>0)r.push(t),t=e[0];else{if(!(r.length>0))break;t=r.pop()}for(var c=0;c<i.Z.rooms.length;c++)null===i.Z.rooms[c]?a--:!1===i.Z.rooms[c].visited&&(a--,i.Z.rooms[c]=null);return a<o.g.settings.minimumNodes&&(n=!0),console.log("available nodes:   ",a),n}}])&&D(e.prototype,r),t}();o(673),o.g.settings={},o.g.background=new f,o.g.player=new _,o.g.foreground=new b,fetch("./configuration.txt").then((function(t){return t.text()})).then((function(t){(function(t){var e=JSON.parse(t);return e.minimumNodes<Math.pow(e.gridSize,2)*e.removed&&(o.g.settings=e,!0)})(t)?((new T).setupGame(),console.log("map generated"),o.g.background.draw(),console.log("background drawn"),o.g.foreground.update(),console.log("foreground drawn")):console.log("invalid configuration")}))})()})();